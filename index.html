<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="author" content="Jeffrey S. Racine1">
<meta name="author" content="Angda Li2">
<meta name="author" content="Qi Li3">
<title>Boundary Corrected Adaptive Conditional Kernel Density Estimation</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
<link rel="stylesheet" href="custom.css">
<link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script src="index_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script>
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
  </script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Boundary Corrected Adaptive Conditional Kernel Density Estimation</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jeffrey S. Racine<sup>1</sup>
</div>
        <p class="quarto-title-affiliation">
            <sup>1</sup>Department of Economics, Graduate Program in Statistics, McMaster University
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Angda Li<sup>2</sup>
</div>
        <p class="quarto-title-affiliation">
            <sup>2</sup>Department of Economics, Texas A&amp;M University
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Qi Li<sup>3</sup>
</div>
        <p class="quarto-title-affiliation">
            <sup>3</sup>Department of Economics, Texas A&amp;M University
          </p>
    </div>
</div>

  <p class="date">Updated February 18, 2025</p>
</section><section><section id="slide-pro-tips" class="title-slide slide level1 center"><h1>Slide Pro-Tips</h1>
<div>
<ul>
<li><p>View <strong>full screen</strong> in A2L by clicking on the slide and then pressing the F key (press the Esc key to revert)</p></li>
<li><p>Access <strong>navigation menu</strong> by pressing the M key (click X in navigation menu to close)</p></li>
<li><p><strong>Advance</strong> using arrow keys</p></li>
<li><p><strong>Zoom</strong> in by holding down the Alt key in MS Windows, Opt key in macOS or Ctrl key in Linux, and clicking on any screen element (Alt/Opt/Ctrl click again to zoom out)</p></li>
<li><p>Use <strong>copy to clipboard</strong> button for R code blocks (upper right in block) to copy and paste into R/RStudio</p></li>
<li><p><strong>Export to a PDF</strong> by pressing the E key (wait a few seconds, then print [or print using system dialog], enable landscape layout, then save as PDF - press the E key to revert)</p></li>
<li><p>Enable drawing tools - chalk <strong>board</strong> by pressing the B key (B to revert), notes <strong>canvas</strong> by pressing the C key (C to revert), press the Del key to erase, press the D key to <strong>download drawings</strong></p></li>
</ul>
</div>
</section><section id="overview-of-talk" class="slide level2 center"><h2>Overview of Talk</h2>
<ul>
<li class="fragment"><p>This talk is about a proposed boundary adaptive, polynomial order adaptive, conditional kernel density estimator, and its finite-sample performance.</p></li>
<li class="fragment"><p>I am aiming for an interactive seminar format, which will require either your participation or your sitting next to someone who is participating.</p></li>
<li class="fragment"><p>Hopefully you came with your laptop, the Firefox browser, R/RStudio, and the suggested libraries installed (if you have your laptop you can do this now if you didn’t get the <a href="https://jeffreyracine.github.io/bk/prelim.html">memo</a>).</p></li>
<li class="fragment"><p>If you have R/RStudio and the libraries installed, you can work with the methods and data interactively as the talk proceeds.</p></li>
<li class="fragment"><p>My hope is that you will follow along and reproduce the results on your own computer.</p></li>
<li class="fragment">
<p>Let’s begin by opening the following link in Firefox:</p>
<p><a href="https://jeffreyracine.github.io/bk" class="uri">https://jeffreyracine.github.io/bk</a></p>
</li>
</ul></section><section id="overview-of-talk-1" class="slide level2 center"><h2>Overview of Talk</h2>
<ul>
<li class="fragment">
<p>We will cover the following topics:</p>
<ol type="1">
<li class="fragment">Unconditional kernel density estimation with/without bounded data</li>
<li class="fragment">Conditional kernel density estimation</li>
<li class="fragment">Conditional local polynomial kernel density estimation</li>
<li class="fragment">Conditional density estimation, bandwidth and polynomial order selection</li>
<li class="fragment">Conditional density estimation, bandwidth and polynomial order selection with/without bounded data</li>
<li class="fragment">Theoretical underpinnings, uniform consistency results, pointwise, Bonferroni, and simultaneous confidence intervals</li>
</ol>
</li>
<li class="fragment">
<p>An R package is available at:</p>
<p><a href="https://github.com/JeffreyRacine/bkcde" class="uri">https://github.com/JeffreyRacine/bkcde</a></p>
</li>
</ul></section></section><section><section id="unconditional-density-estimation-with-bounded-data" class="title-slide slide level1 center"><h1>Unconditional Density Estimation with Bounded Data</h1>

</section><section id="kde-with-bounded-data" class="slide level2 center"><h2>KDE with Bounded Data</h2>
<ul>
<li class="fragment"><p>Kernel density estimation has a rich history <span class="citation" data-cites="ROSENBLATT:1956 PARZEN:1962">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Rosenblatt 1956</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Parzen 1962</a>)</span></p></li>
<li class="fragment"><p>Assuming smoothness, an unknown density <span class="math inline">\(f(x)\)</span> can be estimated using a local average of weight (“kernel”) functions, <span class="math display">\[\begin{equation*}
\hat f(x)=\frac{1}{n}\sum_{i=1}^n \frac{1}{h}K\left(\frac{x-X_i}{h}\right),
\end{equation*}\]</span> where <span class="math inline">\(K(\cdot)\)</span> is a kernel function, <span class="math inline">\(h\)</span> is a bandwidth, and <span class="math inline">\(X_i\)</span> are the data</p></li>
</ul>
<!-- -   For consistency we typically require the bandwidth to vanish asymptotically ($h\to 0$ as $n\to\infty$) --><ul>
<li class="fragment"><p>However, in the presence of finite bounds (e.g., <span class="math inline">\(X\in[a,b]\)</span>, <span class="math inline">\(a&lt;b\)</span>, <span class="math inline">\(|a|&lt;\infty\)</span>, <span class="math inline">\(|b|&lt;\infty\)</span>) “classical” kernels (e.g., Gaussian, Epanechnikov) can behave poorly at the boundary of support; <span class="math inline">\(\hat f(x)\)</span> may converge very slowly at or near boundaries, or even be inconsistent</p></li>
<li class="fragment"><p>This artifact is known as the “edge” or “boundary” effect</p></li>
<li class="fragment"><p>Let’s examine this feature via some interactive illustrations</p></li>
</ul></section><section id="example-of-kde-with-bounded-data---boundary-bias" class="slide level2 center"><h2>Example of KDE with Bounded Data - Boundary Bias</h2>
<p>We simulate two datasets, one <span class="math inline">\(N(0,1)\)</span> and one <span class="math inline">\(U[0,1]\)</span>, and use data-driven methods of bandwidth selection with a “classical” Gaussian kernel to estimate unknown smooth densities, <span class="math inline">\(f(x)\)</span></p>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (<span class="math inline">\(N(0,1)\)</span> (left figure), <span class="math inline">\(U{[0,1]}\)</span> (right figure), R function density())</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-2"><a href=""></a><span class="do">## Simulate n=1000 observations from N(0,1) and U[0,1]</span></span>
<span id="cb1-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-4"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-5"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb1-6"><a href=""></a><span class="do">## Plot the density using R's density() for N(0,1)</span></span>
<span id="cb1-7"><a href=""></a>?density</span>
<span id="cb1-8"><a href=""></a><span class="fu">plot</span>(<span class="fu">density</span>(x),<span class="at">main=</span><span class="st">"Gaussian Data"</span>)</span>
<span id="cb1-9"><a href=""></a><span class="fu">lines</span>(x,<span class="fu">dnorm</span>(x),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1-10"><a href=""></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"DGP"</span>,<span class="st">"density()"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb1-11"><a href=""></a><span class="fu">rug</span>(x)</span>
<span id="cb1-12"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">1000</span>))</span>
<span id="cb1-13"><a href=""></a><span class="do">## Plot the density using R's density() for U[0,1]</span></span>
<span id="cb1-14"><a href=""></a><span class="fu">plot</span>(<span class="fu">density</span>(x),<span class="at">main=</span><span class="st">"Uniform Data"</span>)</span>
<span id="cb1-15"><a href=""></a><span class="fu">lines</span>(x,<span class="fu">dunif</span>(x),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1-16"><a href=""></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1-17"><a href=""></a><span class="fu">segments</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1-18"><a href=""></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"DGP"</span>,<span class="st">"density()"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb1-19"><a href=""></a><span class="fu">rug</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="example-of-kde-with-bounded-data---boundary-bias-output" class="slide level2 output-location-slide center"><h2>Example of KDE with Bounded Data - Boundary Bias</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-simulated-kde-norm-unif" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-simulated-kde-norm-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-simulated-kde-norm-unif-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simulated-kde-norm-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Simulated data from <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(U[0,1]\)</span> with classical KDE
</figcaption></figure>
</div>
</div>
</div></section><section id="kde-with-bounded-data---reflection-transformation" class="slide level2 center"><h2>KDE with Bounded Data - Reflection, Transformation</h2>
<ul>
<li class="fragment"><p>Boundary bias arises mostly when there is substantial probability mass at a support boundary</p></li>
<li class="fragment"><p>Boundary bias when (finite) bounds <span class="math inline">\([a,b]\)</span> are known <em>a-priori</em> has been widely studied</p></li>
<li class="fragment"><p>A number of procedures exist, including <em>data-reflection</em>, <em>data-transformation</em> and the use of <em>kernel carpentry</em> (i.e., so-called “boundary kernels”)</p></li>
<li class="fragment"><p><em>Data-reflection</em> involves duplicating symmetrically (i.e., reflecting) data around its boundary, running standard bandwidth selection and kernel estimation, then adjusting the resulting estimate to ensure it is proper</p></li>
<li class="fragment"><p><em>Data-transformation</em> involves some mathematical transform of the data that, when rescaled, has the desired effect</p></li>
</ul></section><section id="kde-with-bounded-data---carpentry" class="slide level2 center"><h2>KDE with Bounded Data - Carpentry</h2>
<ul>
<li class="fragment"><p><em>Kernel carpentry</em> constructs kernels that <em>adjust</em> to the presence of boundaries</p></li>
<li class="fragment">
<p>A range of left- and right-bounded kernels have been proposed for three cases:</p>
<ul>
<li class="fragment">
<span class="math inline">\([a,b]=[a_0,\infty]\)</span>, <span class="math inline">\(|a_0|&lt;\infty\)</span>
</li>
<li class="fragment">
<span class="math inline">\([a,b]=[-\infty,b_0]\)</span>, <span class="math inline">\(|b_0|&lt;\infty\)</span><br>
</li>
<li class="fragment">
<span class="math inline">\([a,b]=[a_0,b_0]\)</span>, <span class="math inline">\(|a_0|&lt;\infty\)</span> and <span class="math inline">\(|b_0|&lt;\infty\)</span>, <span class="math inline">\(a_0&lt;b_0\)</span>
</li>
</ul>
</li>
<li class="fragment"><p>Some proposed estimators even require the use of different kernel types near the boundary versus in the interior of support, and also different degrees of smoothing in boundary regions (“floating-boundary”, <span class="citation" data-cites="SCOTT:1992">Scott (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1992</a>)</span>)</p></li>
<li class="fragment"><p>To some degree, all methods (i.e., reflection, transformation, carpentry) can reduce the amount of bias that would otherwise be present near a boundary to that which holds in the interior of support where it is free from boundary effects</p></li>
</ul></section><section id="kde-with-bounded-data---carpentry-1" class="slide level2 center"><h2>KDE with Bounded Data - Carpentry</h2>
<ul>
<li class="fragment">
<p>Existing boundary kernel functions include</p>
<ul>
<li class="fragment"><p>Beta kernels (<span class="math inline">\(x\in[a,b]\)</span>, <span class="math inline">\(|a|&lt;\infty\)</span>, <span class="math inline">\(|b|&lt;\infty\)</span>, <span class="math inline">\(a&lt;b\)</span>) <span class="citation" data-cites="CHEN:1999 BOUEZMARNI_ROLIN:2003 ZHANG_KARUNAMUNI:2010 IGARASHI:2016">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Chen 1999</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Bouezmarni and Rolin 2003</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Zhang and Karunamuni 2010</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Igarashi 2016</a>)</span></p></li>
<li class="fragment"><p>Gamma kenels (<span class="math inline">\(x\in[a,\infty]\)</span>, <span class="math inline">\(|a|&lt;\infty\)</span>) <span class="citation" data-cites="CHEN:2000 MALEC201457">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Chen 2000</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Malec and Schienle 2014</a>)</span></p></li>
<li class="fragment"><p>Inverse and Reciprocal Inverse Gaussian kernels (<span class="math inline">\(x\in[a,b]\)</span>, <span class="math inline">\(|a|&lt;\infty\)</span>, <span class="math inline">\(|b|&lt;\infty\)</span>, <span class="math inline">\(a&lt;b\)</span>) <span class="citation" data-cites="SCAILLET:2004 IGARASHI_KAKIZAWA:2014">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Scaillet 2004</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Igarashi and Kakizawa 2014</a>)</span></p></li>
</ul>
</li>
<li class="fragment">
<p>Regarding the use of boundary kernels, <span class="citation" data-cites="SCOTT:1992">Scott (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1992</a>)</span>, p 149, notes:</p>
<blockquote>
<p>“<em>While boundary kernels can be very useful, there are potentially serious problems with real data. There are an infinite number of boundary kernels reflecting the spectrum of possible design constraints, and these kernels are not interchangeable. Severe artifacts can be introduced by any one of them in inappropriate situations. Very careful examination is required to avoid being victimized by the particular boundary kernel chosen. Artifacts can unfortunately be introduced by the choice of the support interval for the boundary kernel.</em>”</p>
</blockquote>
</li>
</ul></section><section id="kde-with-bounded-data---a-priori-information" class="slide level2 center"><h2>KDE with Bounded Data - A Priori Information</h2>
<ul>
<li class="fragment"><p>It bears noting that virtually all existing boundary kernels require the bounds to be known <em>a priori</em></p></li>
<li class="fragment"><p>Furthermore, they typically involve weight functions bounded on finite intervals <span class="math inline">\([a,b]\)</span> (e.g., the Beta (<span class="math inline">\(x\in[a,b]\)</span>) and Gamma kernels (<span class="math inline">\(x\in[a,\infty]\)</span>) where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are finite)</p></li>
<li class="fragment"><p>A more recent addition is the Gaussian kernel (<span class="math inline">\(x\in[a,b]\)</span>, <span class="math inline">\(|a|\le\infty\)</span>, <span class="math inline">\(|b|\le\infty\)</span>, <span class="math inline">\(a&lt;b\)</span>) of <span class="citation" data-cites="RACINE_LI_WANG:2024">Racine, Li, and Wang (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2024</a>)</span></p></li>
<li class="fragment">
<p>Unlike its peers, however, the kernel proposed by <span class="citation" data-cites="RACINE_LI_WANG:2024">Racine, Li, and Wang (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2024</a>)</span>,</p>
<ul>
<li class="fragment">is applicable whether or not bounds are known a-priori</li>
<li class="fragment">allows <span class="math inline">\(a\)</span> and/or <span class="math inline">\(b\)</span> to be infinite</li>
</ul>
</li>
</ul></section><section id="kde-with-bounded-data---shrinkage" class="slide level2 center"><h2>KDE with Bounded Data - Shrinkage</h2>
<ul>
<li class="fragment"><p>If bounds are known, naturally one should use that information</p></li>
<li class="fragment"><p>But in the presence of <em>unknown</em> bounds, <span class="citation" data-cites="RACINE_LI_WANG:2024">Racine, Li, and Wang (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2024</a>)</span> considered a simple kernel function that can <em>automatically</em> adapt (more shortly) <em>and</em> nests the classical Gaussian kernel with <span class="math inline">\(Y\in[-\infty,\infty]\)</span> as a special case</p></li>
<li class="fragment"><p>They considered a classical method of bandwidth selection and demonstrated that it can deliver consistent estimates even when <span class="math inline">\(h\to\infty\)</span> as <span class="math inline">\(n\to\infty\)</span> is appropriate, which violates classical conditions for consistency</p></li>
<li class="fragment"><p>This result is the <em>unconditional counterpart</em> to the <em>conditional</em> result provided by <span class="citation" data-cites="HALL_RACINE_LI:2004">Hall, Racine, and Li (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2004</a>)</span> who showed that cross-validated bandwidth selection “automatically determines which components are relevant and which are not, through assigning large smoothing parameters to the latter and consequently <strong>shrinking</strong> them toward the uniform distribution on the respective marginals”</p></li>
<li class="fragment"><p>Here we observe shinkage in the Bayesian sense <span class="citation" data-cites="KIEFER_RACINE:2009 KIEFER_RACINE:2015">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Kiefer 2009</a>, <a href="#/references-scrollable" role="doc-biblioref" onclick="">2015</a>)</span></p></li>
</ul></section><section id="kde-with-bounded-data---bandwidths-and-shrinkage" class="slide level2 center"><h2>KDE with Bounded Data - Bandwidths and Shrinkage</h2>
<ul>
<li class="fragment"><p>For <span class="math inline">\(x\in [a,b]\)</span> and kernel <span class="math inline">\(K(z)\)</span> (e.g., Gaussian or Epanechnikov), a simple boundary kernel <span class="math inline">\(K_{[a,b]}(z)\)</span> is constructed as follows <span class="citation" data-cites="RACINE_LI_WANG:2024">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Racine, Li, and Wang 2024</a>)</span>: <span class="math display">\[\begin{equation*}
K_{[a,b]}(z)=\left\{
\begin{array}{cl}
\frac{K(z)}{G(z_b)-G(z_a)}&amp;\text{ if } z_a\le z\le z_b,\\
0 &amp; \text{ otherwise}
\end{array}
\right.
\end{equation*}\]</span></p></li>
<li class="fragment"><p>Here, <span class="math inline">\(z=(x-X_i)/h\)</span>, <span class="math inline">\(z_b=(b-x)/h\)</span>, and <span class="math inline">\(z_a=(a-x)/h\)</span>, and where <span class="math inline">\(G(z)=\int_{-\infty}^z K(t)\,dt\)</span></p></li>
</ul>
<!--
- Since $K(z)$ is a standard univariate kernel function, $G(z)$ is the CDF counterpart to the PDF $K(z)$ that we used to estimate $F(x)$
--><ul>
<li class="fragment">
<p>The key to this kernel formulation lies in its <em>adaptability</em>:</p>
<ul>
<li class="fragment">If <span class="math inline">\(K(z)\)</span> has infinite support then <span class="math inline">\(K_{[a,b]}(z)\)</span> <em>seamlessly admits infinite support situations without modification</em> (i.e., <span class="math inline">\([a,b]=[-\infty,\infty]\)</span>, <span class="math inline">\([a,b]=[-\infty,b_0]\)</span>, <span class="math inline">\([a,b]=[a_0,\infty]\)</span>, <span class="math inline">\([a,b]=[a_0,b_0]\)</span> for <span class="math inline">\(|a_0|&lt;\infty\)</span> and <span class="math inline">\(|b_0|&lt;\infty\)</span>, <span class="math inline">\(a_0&lt;b_0\)</span>)</li>
<li class="fragment">If the bounds are unknown, the kernel can <em>automatically adapt</em> to the range of the data</li>
</ul>
</li>
</ul></section><section id="unconditional-kde-in-r---cps-age-distribution" class="slide level2 center"><h2>Unconditional KDE in R - CPS Age Distribution</h2>
<p>Let’s consider an illustration where we estimate the distribution of ages for working age males from a random sample taken from the Current Population Survey (CPS) using the classical kernel and that of <span class="citation" data-cites="RACINE_LI_WANG:2024">Racine, Li, and Wang (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2024</a>)</span> when bounds are <em>not</em> assumed to be known <em>a priori</em> (we use the empirical support <span class="math inline">\([\min(X),\max(X)]\)</span>)</p>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (Canadian High School Graduate Age Distribution 21-65)</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">library</span>(np)</span>
<span id="cb2-2"><a href=""></a><span class="do">## Display help for npuniden.boundary</span></span>
<span id="cb2-3"><a href=""></a>?npuniden.boundary</span>
<span id="cb2-4"><a href=""></a><span class="fu">data</span>(cps71)</span>
<span id="cb2-5"><a href=""></a><span class="fu">attach</span>(cps71)</span>
<span id="cb2-6"><a href=""></a><span class="do">## Use npuniden.boundary() with unknown bounds</span></span>
<span id="cb2-7"><a href=""></a>model <span class="ot">&lt;-</span> <span class="fu">npuniden.boundary</span>(age)</span>
<span id="cb2-8"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb2-9"><a href=""></a><span class="fu">hist</span>(age,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb2-10"><a href=""></a><span class="do">## Plot the boundary-corrected KDE</span></span>
<span id="cb2-11"><a href=""></a><span class="fu">lines</span>(age,model<span class="sc">$</span>f)</span>
<span id="cb2-12"><a href=""></a><span class="do">## Plot the classical density using R's density()</span></span>
<span id="cb2-13"><a href=""></a><span class="fu">lines</span>(<span class="fu">density</span>(age),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb2-14"><a href=""></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="fu">c</span>(<span class="st">"Boundary Kernel (unknown bounds)"</span>,<span class="st">"Classical density()"</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">bty=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="unconditional-kde-in-r---cps-age-distribution-output" class="slide level2 output-location-slide center"><h2>Unconditional KDE in R - CPS Age Distribution</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-cps-age" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-cps-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-cps-age-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cps-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Age distribution of Canadian high school graduates
</figcaption></figure>
</div>
</div>
</div></section><section id="unconditional-kde-in-r---simulated-data" class="slide level2 center"><h2>Unconditional KDE in R - Simulated Data</h2>
<p>Now let’s consider some simulated data drawn from the <span class="math inline">\(U[0,1]\)</span> and assess the shrinkage phenomenon</p>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (<span class="math inline">\(N(0,1)\)</span> (left figure), <span class="math inline">\(U{[0,1]}\)</span> (right figure), R function density())</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="do">## Consider the previous simulated illustration and add the boundary-corrected</span></span>
<span id="cb3-2"><a href=""></a><span class="do">## KDE</span></span>
<span id="cb3-3"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb3-4"><a href=""></a><span class="do">## Simulate n=1000 observations from N(0,1) and U[0,1]</span></span>
<span id="cb3-5"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-6"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">cex=</span>.<span class="dv">8</span>)</span>
<span id="cb3-7"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb3-8"><a href=""></a>model <span class="ot">&lt;-</span> <span class="fu">npuniden.boundary</span>(x)</span>
<span id="cb3-9"><a href=""></a><span class="do">## Plot the density using R's density() for N(0,1)</span></span>
<span id="cb3-10"><a href=""></a><span class="fu">plot</span>(<span class="fu">density</span>(x),<span class="at">main=</span><span class="st">"Gaussian Data"</span>)</span>
<span id="cb3-11"><a href=""></a><span class="fu">lines</span>(x,<span class="fu">dnorm</span>(x),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-12"><a href=""></a><span class="fu">lines</span>(x,model<span class="sc">$</span>f,<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-13"><a href=""></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"DGP"</span>,<span class="st">"density()"</span>,<span class="st">"Boundary Kernel (unknown bounds)"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb3-14"><a href=""></a><span class="fu">rug</span>(x)</span>
<span id="cb3-15"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">1000</span>))</span>
<span id="cb3-16"><a href=""></a>model <span class="ot">&lt;-</span> <span class="fu">npuniden.boundary</span>(x)</span>
<span id="cb3-17"><a href=""></a><span class="do">## Plot the density using R's density() for U[0,1]</span></span>
<span id="cb3-18"><a href=""></a><span class="fu">plot</span>(<span class="fu">density</span>(x),<span class="at">main=</span><span class="st">"Uniform Data"</span>)</span>
<span id="cb3-19"><a href=""></a><span class="fu">lines</span>(x,<span class="fu">dunif</span>(x),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-20"><a href=""></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-21"><a href=""></a><span class="fu">segments</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-22"><a href=""></a><span class="fu">lines</span>(x,model<span class="sc">$</span>f,<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-23"><a href=""></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"DGP"</span>,<span class="st">"density()"</span>,<span class="st">"Boundary Kernel (unknown bounds)"</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb3-24"><a href=""></a><span class="fu">rug</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="unconditional-kde-in-r---simulated-data-output" class="slide level2 output-location-slide center"><h2>Unconditional KDE in R - Simulated Data</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-simulated-kde" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-simulated-kde-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-simulated-kde-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simulated-kde-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Simulated data from <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(U[0,1]\)</span> with boundary-corrected KDE
</figcaption></figure>
</div>
</div>
</div></section></section><section><section id="conditional-density-estimation" class="title-slide slide level1 center"><h1>Conditional Density Estimation</h1>

</section><section id="conditional-kde" class="slide level2 center"><h2>Conditional KDE</h2>
<ul>
<li class="fragment"><p>The conditional PDF <span class="math inline">\(f(y|x)=f(y,x)/f(x)\)</span> is a fundamental object in statistics</p></li>
<li class="fragment">
<p>Related objects include</p>
<ul>
<li class="fragment">The conditional CDF <span class="math inline">\(F(y|x)=\int_{-\infty}^y f(t|x)dt=\int_{-\infty}^y f(t,x)dt/f(x)\)</span>
</li>
<li class="fragment">The conditional expectation <span class="math inline">\(E(Y|X=x)=\int_{-\infty}^{\infty} yf(y|x)dy\)</span>
</li>
<li class="fragment">The conditional quantile <span class="math inline">\(Q_{\tau}(x)=\inf\{y:F(y|x)\ge \tau\}\)</span>, etc.</li>
</ul>
</li>
<li class="fragment"><p>Also, derivatives are often required for constructing marginal effects, e.g.&nbsp;<span class="math inline">\(d E(Y|X=x)/d x\)</span>, along with counterparts for the conditional distribution function and quantile function</p></li>
<li class="fragment"><p>Sound nonparametric estimation must address a range of issues including boundary bias, bandwidth selection, choice of kernel function, and the choice of the order of the local polynomial approximation</p></li>
</ul></section><section id="conditional-kde-1" class="slide level2 center"><h2>Conditional KDE</h2>
<ul>
<li class="fragment"><p>We consider the estimation of the conditional density <span class="math inline">\(f(y|x)=f(y,x)/f(x)\)</span> when <span class="math inline">\(Y\in[a,b]\)</span></p></li>
<li class="fragment"><p>The classical case is when <span class="math inline">\(X\)</span> is continuous and <span class="math inline">\(Y\)</span> is continuous lying in <span class="math inline">\([-\infty,\infty]\)</span>, and we are interested in estimating <span class="math inline">\(f(y|x)\)</span></p></li>
<li class="fragment"><p>The classical case replaces <span class="math inline">\(f(x,y)\)</span> and <span class="math inline">\(f(x)\)</span> with their kernel estimates and then divides the former by the latter keeping the same bandwidth <span class="math inline">\(h_x\)</span> for the numerator and denominator, which can also be derived as the solution to a local polynomial approximation problem</p></li>
<li class="fragment"><p>The resulting kernel density estimator of the conditional PDF with <span class="math inline">\(Y\in\mathbb{R}^1\)</span> and <span class="math inline">\(X\in\mathbb{R}^1\)</span> is given by <span class="math display">\[\begin{equation*}
\hat f(y|x) = \frac{\hat f(y,x)}{\hat f(x)}=\frac{\sum_{i=1}^nh_y^{-1}h_x^{-1}K\left(\frac{Y_i-y}{h_y}\right)K\left(\frac{X_i-x}{h_x}\right)}{\sum_{i=1}^nh_x^{-1}K\left(\frac{X_i-x}{h_x}\right)}.
\end{equation*}\]</span></p></li>
</ul></section><section id="local-polynomial-conditional-kde" class="slide level2 center"><h2>Local Polynomial Conditional KDE</h2>
<ul>
<li class="fragment"><p>This estimator is also the solution to a locally weighted least squares regression of <span class="math inline">\(h_y^{-1}K\left(\frac{Y_i-y}{h_y}\right)\)</span> on a constant <span class="math inline">\(\alpha\)</span> using local weights <span class="math inline">\(h_x^{-1}K\left(\frac{X_i-x}{h_x}\right)\)</span>, i.e., <span class="math display">\[\begin{equation*}
\hat \alpha = \operatorname{argmin}_{\alpha}\sum_{i=1}^n\left(h_y^{-1}K\left(\frac{Y_i-y}{h_y}\right)-\alpha\right)^2h_x^{-1}K\left(\frac{X_i-x}{h_x}\right),
\end{equation*}\]</span> which delivers <span class="math inline">\(\hat\alpha=\hat f(y|x)\)</span> identical to that from the previous approach.</p></li>
<li class="fragment"><p>The local polynomial extension of this estimator is given by <span class="math display">\[\begin{equation*}
\hat \alpha = \operatorname{argmin}_{\alpha}\sum_{i=1}^n\left(h_y^{-1}K\left(\frac{Y_i-y}{h_y}\right)-\sum_{j=0}^p\alpha_j(x-X_i)^j\right)^2h_x^{-1}K\left(\frac{X_i-x}{h_x}\right),
\end{equation*}\]</span> which delivers <span class="math inline">\(\hat\alpha_0=\hat f(y|x)\)</span>, a <span class="math inline">\(p\)</span>-th order local polynomial estimator.</p></li>
</ul></section><section id="local-polynomial-conditional-kde-1" class="slide level2 center"><h2>Local Polynomial Conditional KDE</h2>
<ul>
<li class="fragment"><p>The local polynomial estimator is often adopted for its boundary properties with odd-order polynomials <span class="math inline">\(p\ge 1\)</span></p></li>
<li class="fragment"><p>These properties are that the bias at the boundary is the same order as that in the interior of support, unlike that for the classical estimator with <span class="math inline">\(p=0\)</span></p></li>
<li class="fragment"><p>But, the local polynomial estimator is not without its own problems, in particular the estimated density can be negative and fail to integrate to unity (i.e., is not guaranteed to be proper)</p></li>
<li class="fragment">
<p>Then there is the conventional wisdom about polynomial order selection <span class="citation" data-cites="FAN_GIJBELS:1995 FAN_GIJBELS:1996">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Fan and Gijbels 1995</a>, p 59; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Fan and Gijbels 1996</a>)</span>:</p>
<blockquote>
<p>“Another issue in local polynomial fitting is the choice of the order of the local polynomial. Since the modelling bias is primarily controlled by the bandwidth, this issue is less crucial however. [] Since the bandwidth is used to control the modelling complexity, we recommend the use of the lowest odd order, i.e.&nbsp;<span class="math inline">\(p=\nu+1\)</span>, or occasionally <span class="math inline">\(p=\nu+3\)</span>. [<span class="math inline">\(\nu\)</span> is the order of the derivative required].”</p>
</blockquote>
</li>
</ul></section></section><section><section id="conditional-density-estimation-bandwidth-and-polynomial-order-selection" class="title-slide slide level1 center"><h1>Conditional Density Estimation:<br> Bandwidth and Polynomial Order Selection</h1>

</section><section id="conditional-kde---bandwidth-selection" class="slide level2 center"><h2>Conditional KDE - Bandwidth Selection</h2>
<ul>
<li class="fragment"><p>Classical least squares cross-validation is a fully automatic and data-driven method of selecting the bandwidth with <span class="math inline">\(Y\in[-\infty,\infty]\)</span> and fixed polynomial order <span class="citation" data-cites="RUDEMO:1982 BOWMAN:1984 HALL_RACINE_LI:2004">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Rudemo 1982</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Bowman 1984</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Hall, Racine, and Li 2004</a>)</span></p></li>
<li class="fragment"><p>This method is based on the principle of selecting a bandwidth that minimizes the integrated square error (ISE(<span class="math inline">\(h_x\)</span>,<span class="math inline">\(h_y\)</span>) of the resulting estimate</p></li>
<li class="fragment"><p>The integrated squared difference between <span class="math inline">\(\hat f(y|x)\)</span> and <span class="math inline">\(f(y|x)\)</span> is <span class="math display">\[\begin{equation*}
\int \left(\hat f(y|x) - f(y|x)\right)^2\, dx = \int \hat f(y|x)^2\, dx - 2\int \hat f(y|x) f(y|x)\, dx + \int f(y|x)^2\, dy
\end{equation*}\]</span></p></li>
<li class="fragment"><p>The third term can be ignored since it does not depend on <span class="math inline">\(h_x\)</span> or <span class="math inline">\(h_y\)</span></p></li>
<li class="fragment"><p>Replacing the first two terms with their sample counterparts and adjusting for bias, we can minimize ISE(<span class="math inline">\(h_x\)</span>,<span class="math inline">\(h_y\)</span>) with respect to <span class="math inline">\(h_x\)</span> and <span class="math inline">\(h_y\)</span></p></li>
</ul></section><section id="conditional-kde---bandwidth-and-order-selection" class="slide level2 center"><h2>Conditional KDE - Bandwidth and Order Selection</h2>
<ul>
<li class="fragment"><p><span class="citation" data-cites="HALL_RACINE:2015">Hall and Racine (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2015</a>)</span> consider local polynomial kernel regression where, jointly, the polynomial order and bandwidths are selected via cross-validation</p></li>
<li class="fragment"><p>They argue that the polynomial order selection cannot be fixed at an ad hoc value since the optimal order depends on the unknown DGP, as do the bandwidths, <em>contrary to the conventional wisdom</em> <span class="citation" data-cites="FAN_GIJBELS:1995 FAN_GIJBELS:1996">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Fan and Gijbels 1995</a>, p 59; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Fan and Gijbels 1996</a>)</span></p></li>
<li class="fragment"><p>This joint optimization of the polynomial order vector (integers) and the bandwidth vector (continuous positive bounded scalars <span class="math inline">\(&gt;0\)</span>), is a <em>mixed-integer</em> problem that can be solved using the <code>NOMAD</code> algorithm <span class="citation" data-cites="LEDIGABEL:2011 NOMAD">(<a href="#/references-scrollable" role="doc-biblioref" onclick="">Le Digabel 2011</a>; <a href="#/references-scrollable" role="doc-biblioref" onclick="">Abramson et al. 2022</a>)</span></p></li>
<li class="fragment"><p>We extend this to the conditional density estimation case, where the choice of polynomial order is also crucial</p></li>
<li class="fragment"><p>We minimize ISE(<span class="math inline">\(p\)</span>, <span class="math inline">\(h_x\)</span>,<span class="math inline">\(h_y\)</span>), while the classical approach minimizes ISE(<span class="math inline">\(h_x\)</span>,<span class="math inline">\(h_y\)</span>) for ad hoc <span class="math inline">\(p\)</span></p></li>
</ul></section></section><section><section id="conditional-density-estimation---bandwidth-and-polynomial-order-selection" class="title-slide slide level1 center"><h1>Conditional Density Estimation - Bandwidth and Polynomial Order Selection</h1>

</section><section id="conditional-kde---bandwidth-and-order-selection-with-bounded-y" class="slide level2 center"><h2>Conditional KDE - Bandwidth and Order Selection with Bounded <span class="math inline">\(Y\)</span>
</h2>
<ul>
<li class="fragment"><p>We consider the case where <span class="math inline">\(Y\in[a,b]\)</span> and <span class="math inline">\(X\in\mathbb{R}^1\)</span>, and allow for the bounds to be known or unknown a priori</p></li>
<li class="fragment"><p>The local polynomial estimator using the boundary adaptive kernel <span class="math inline">\(K_{[a,b]}(z_y)\)</span> is <span class="math inline">\(\hat\alpha_0=\hat f(y|x)\)</span> from the solution of <span class="math display">\[\begin{equation*}
\hat \alpha = \operatorname{argmin}_{\alpha}\sum_{i=1}^n\left(h_y^{-1}K_{[a,b]}\left(\frac{Y_i-y}{h_y}\right)-\sum_{j=0}^p\alpha_j(x-X_i)^j\right)^2h_x^{-1}K\left(\frac{X_i-x}{h_x}\right)
\end{equation*}\]</span></p></li>
<li class="fragment"><p>We minimize ISE(<span class="math inline">\(p\)</span>, <span class="math inline">\(h_x\)</span>,<span class="math inline">\(h_y\)</span>) with known bounds <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> or unknown bounds using the empirical support <span class="math inline">\([\hat a,\hat b]=[\min(Y),\max(Y)]\)</span></p></li>
<li class="fragment"><p>We provide uniform consistency results for the resulting estimator</p></li>
<li class="fragment"><p>This supports the construction of uniform or “simultaneous” confidence intervals</p></li>
<li class="fragment"><p>Let’s consider some illustrations of the fully data-driven method of bandwidth and polynomial order selection</p></li>
</ul></section><section id="example---conditional-kde-with-bounded-y-and-irrelevant-x" class="slide level2 center"><h2>Example - Conditional KDE with Bounded <span class="math inline">\(Y\)</span> and Irrelevant <span class="math inline">\(X\)</span>
</h2>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (Uniform, Irrelevant <span class="math inline">\(X\)</span>)</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">library</span>(bkcde)</span>
<span id="cb4-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">350</span></span>
<span id="cb4-4"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb4-5"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-6"><a href=""></a>f <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-7"><a href=""></a>f.classic <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>,</span>
<span id="cb4-8"><a href=""></a>                   <span class="at">y.ub=</span><span class="cn">Inf</span>,</span>
<span id="cb4-9"><a href=""></a>                   <span class="at">y.lb=</span><span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb4-10"><a href=""></a>                   <span class="at">x.ub=</span><span class="cn">Inf</span>,</span>
<span id="cb4-11"><a href=""></a>                   <span class="at">x.lb=</span><span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb4-12"><a href=""></a>                   <span class="at">degree.min=</span><span class="dv">0</span>,</span>
<span id="cb4-13"><a href=""></a>                   <span class="at">degree.max=</span><span class="dv">0</span>)</span>
<span id="cb4-14"><a href=""></a>dgp <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(f<span class="sc">$</span>y.eval,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-15"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">cex=</span>.<span class="dv">75</span>,<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb4-16"><a href=""></a>zlim <span class="ot">&lt;-</span> <span class="fu">range</span>(f<span class="sc">$</span>f,f.classic<span class="sc">$</span>f,dgp,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-17"><a href=""></a><span class="fu">plot</span>(f.classic,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Estimated Density (Classic, p = 0), n = "</span>,n),<span class="at">zlim=</span>zlim)</span>
<span id="cb4-18"><a href=""></a><span class="fu">plot</span>(f,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Estimated Density (Bounded, p = "</span>,f<span class="sc">$</span>degree,<span class="st">"), n = "</span>,n,<span class="at">sep=</span><span class="st">""</span>),<span class="at">zlim=</span>zlim)</span>
<span id="cb4-19"><a href=""></a><span class="fu">persp</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval),<span class="fu">unique</span>(f<span class="sc">$</span>y.eval),</span>
<span id="cb4-20"><a href=""></a>      <span class="fu">matrix</span>(dgp,<span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval))),</span>
<span id="cb4-21"><a href=""></a>      <span class="at">theta=</span><span class="dv">120</span>,<span class="at">phi=</span><span class="dv">45</span>,<span class="at">ticktype=</span><span class="st">"detailed"</span>,<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">ylab=</span><span class="st">"y"</span>,<span class="at">zlab=</span><span class="st">"f(y|x)"</span>,<span class="at">zlim=</span>zlim,<span class="at">main=</span><span class="st">"True density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="example---conditional-kde-with-bounded-y-and-irrelevant-x-output" class="slide level2 output-location-slide center"><h2>Example - Conditional KDE with Bounded <span class="math inline">\(Y\)</span> and Irrelevant <span class="math inline">\(X\)</span>
</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-conditional-kde-uniform" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-conditional-kde-uniform-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-conditional-kde-uniform-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conditional-kde-uniform-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Conditional KDE for <span class="math inline">\(U[0,1]\)</span> with classical bounds and ad hoc order (<span class="math inline">\(Y\in[-\infty,\infty]\)</span>, <span class="math inline">\(p=0\)</span>), empirical bounds with adaptive polynomial choice (<span class="math inline">\(Y\in[\min(Y),\max(Y)]\)</span>)
</figcaption></figure>
</div>
</div>
</div></section><section id="example---conditional-kde-with-unbounded-y" class="slide level2 center"><h2>Example - Conditional KDE with Unbounded <span class="math inline">\(Y\)</span>
</h2>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (Gaussian, Empirical Bounds)</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">library</span>(bkcde)</span>
<span id="cb5-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb5-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb5-4"><a href=""></a>a <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-5"><a href=""></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href=""></a>sd.unif <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((b<span class="sc">-</span>a)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb5-7"><a href=""></a>sn <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-8"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,a,b)</span>
<span id="cb5-9"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="at">mean=</span>x,<span class="at">sd=</span>sn<span class="sc">*</span>sd.unif)</span>
<span id="cb5-10"><a href=""></a>f <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-11"><a href=""></a>dgp <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(f<span class="sc">$</span>y.eval,<span class="at">mean=</span>f<span class="sc">$</span>x.eval,<span class="at">sd=</span>sn<span class="sc">*</span>sd.unif)</span>
<span id="cb5-12"><a href=""></a>zlim <span class="ot">&lt;-</span> <span class="fu">range</span>(f<span class="sc">$</span>f,dgp)</span>
<span id="cb5-13"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">cex=</span>.<span class="dv">75</span>,<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb5-14"><a href=""></a><span class="fu">plot</span>(f,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Estimated Density, n = "</span>,n),<span class="at">zlim=</span>zlim)</span>
<span id="cb5-15"><a href=""></a><span class="fu">persp</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval),<span class="fu">unique</span>(f<span class="sc">$</span>y.eval),</span>
<span id="cb5-16"><a href=""></a>      <span class="fu">matrix</span>(dgp,<span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval))),</span>
<span id="cb5-17"><a href=""></a>      <span class="at">theta=</span><span class="dv">120</span>,<span class="at">phi=</span><span class="dv">45</span>,<span class="at">ticktype=</span><span class="st">"detailed"</span>,<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">ylab=</span><span class="st">"y"</span>,<span class="at">zlab=</span><span class="st">"f(y|x)"</span>,<span class="at">zlim=</span>zlim,<span class="at">main=</span><span class="st">"True density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="example---conditional-kde-with-unbounded-y-output" class="slide level2 output-location-slide center"><h2>Example - Conditional KDE with Unbounded <span class="math inline">\(Y\)</span>
</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-conditional-kde-gaussian" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-conditional-kde-gaussian-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-conditional-kde-gaussian-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conditional-kde-gaussian-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Conditional KDE for <span class="math inline">\(N(x,1)\)</span> with empirical bounds
</figcaption></figure>
</div>
</div>
</div></section><section id="example---conditional-kde-with-bounded-y" class="slide level2 center"><h2>Example - Conditional KDE with Bounded <span class="math inline">\(Y\)</span>
</h2>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (Beta(1+x,2-x), Empirical Bounds)</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">library</span>(bkcde)</span>
<span id="cb6-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb6-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb6-4"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-5"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">1</span><span class="sc">+</span>x,<span class="dv">2</span><span class="sc">-</span>x)</span>
<span id="cb6-6"><a href=""></a>f <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-7"><a href=""></a>dgp <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(f<span class="sc">$</span>y.eval,<span class="dv">1</span><span class="sc">+</span>f<span class="sc">$</span>x.eval,<span class="dv">2</span><span class="sc">-</span>f<span class="sc">$</span>x.eval)</span>
<span id="cb6-8"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">cex=</span>.<span class="dv">75</span>,<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb6-9"><a href=""></a>zlim <span class="ot">&lt;-</span> <span class="fu">range</span>(f<span class="sc">$</span>f,dgp)</span>
<span id="cb6-10"><a href=""></a><span class="fu">plot</span>(f,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Estimated Density, n = "</span>,n),<span class="at">zlim=</span>zlim)</span>
<span id="cb6-11"><a href=""></a><span class="fu">persp</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval),<span class="fu">unique</span>(f<span class="sc">$</span>y.eval),</span>
<span id="cb6-12"><a href=""></a>      <span class="fu">matrix</span>(dgp,<span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval))),</span>
<span id="cb6-13"><a href=""></a>      <span class="at">theta=</span><span class="dv">120</span>,<span class="at">phi=</span><span class="dv">45</span>,<span class="at">ticktype=</span><span class="st">"detailed"</span>,<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">ylab=</span><span class="st">"y"</span>,<span class="at">zlab=</span><span class="st">"f(y|x)"</span>,<span class="at">zlim=</span>zlim,<span class="at">main=</span><span class="st">"True density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="example---conditional-kde-with-bounded-y-output" class="slide level2 output-location-slide center"><h2>Example - Conditional KDE with Bounded <span class="math inline">\(Y\)</span>
</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-conditional-kde-beta" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-conditional-kde-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-conditional-kde-beta-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conditional-kde-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Conditional KDE for <span class="math inline">\(\textrm{Beta}(1+x,2-x)\)</span> with empirical bounds
</figcaption></figure>
</div>
</div>
</div></section><section id="example---simultaneous-confidence-intervals" class="slide level2 center"><h2>Example - Simultaneous Confidence Intervals</h2>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (Beta, Empirical Bounds, Simultaneous Confidence Intervals)</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="fu">library</span>(bkcde)</span>
<span id="cb7-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb7-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb7-4"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-5"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">1</span><span class="sc">+</span>x,<span class="dv">2</span><span class="sc">-</span>x)</span>
<span id="cb7-6"><a href=""></a>f <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-7"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">cex=</span>.<span class="dv">75</span>,<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb7-8"><a href=""></a>foo <span class="ot">&lt;-</span> <span class="fu">plot</span>(f,<span class="at">ci=</span><span class="cn">TRUE</span>,<span class="at">ci.method=</span><span class="st">"all"</span>,<span class="at">ci.preplot=</span><span class="cn">FALSE</span>,<span class="at">plot.behavior=</span><span class="st">"plot-data"</span>,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Estimated Density, n = "</span>,n))</span>
<span id="cb7-9"><a href=""></a><span class="fu">persp</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval),<span class="fu">unique</span>(f<span class="sc">$</span>y.eval),</span>
<span id="cb7-10"><a href=""></a>      <span class="fu">matrix</span>(<span class="fu">dbeta</span>(f<span class="sc">$</span>y.eval,<span class="dv">1</span><span class="sc">+</span>f<span class="sc">$</span>x.eval,<span class="dv">2</span><span class="sc">-</span>f<span class="sc">$</span>x.eval),<span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(f<span class="sc">$</span>x.eval))),</span>
<span id="cb7-11"><a href=""></a>      <span class="at">theta=</span><span class="dv">120</span>,<span class="at">phi=</span><span class="dv">45</span>,<span class="at">ticktype=</span><span class="st">"detailed"</span>,<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">ylab=</span><span class="st">"y"</span>,<span class="at">zlab=</span><span class="st">"f(y|x)"</span>,<span class="at">zlim=</span>foo<span class="sc">$</span>zlim,<span class="at">main=</span><span class="st">"True density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="example---simultaneous-confidence-intervals-output" class="slide level2 output-location-slide center"><h2>Example - Simultaneous Confidence Intervals</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-conditional-kde-beta-ci" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-conditional-kde-beta-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-conditional-kde-beta-ci-1.png" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conditional-kde-beta-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Conditional KDE for <span class="math inline">\(\textrm{Beta}(1+x,2-x)\)</span> with empirical bounds and simultaneous confidence intervals
</figcaption></figure>
</div>
</div>
</div></section><section id="example---patent-application-data" class="slide level2 center"><h2>Example - Patent Application Data</h2>
<div class="callout callout-note callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example (Annual numbers of European patent applications)</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">library</span>(bkcde)</span>
<span id="cb8-2"><a href=""></a><span class="fu">library</span>(pglm)</span>
<span id="cb8-3"><a href=""></a><span class="do">## Annual observations of 181 firms from 1983 to 1991, number of European patent</span></span>
<span id="cb8-4"><a href=""></a><span class="do">## applications (count), 1629 observations. </span></span>
<span id="cb8-5"><a href=""></a><span class="fu">data</span>(PatentsRD)</span>
<span id="cb8-6"><a href=""></a><span class="fu">attach</span>(PatentsRD)</span>
<span id="cb8-7"><a href=""></a><span class="do">## Patent data often has a preponderance of zeros and "overdispersion". Since</span></span>
<span id="cb8-8"><a href=""></a><span class="do">## the data has a boundary at zero, a zero-inflated negative binomial model is</span></span>
<span id="cb8-9"><a href=""></a><span class="do">## often used. Instead we consider a kernel density estimation approach that</span></span>
<span id="cb8-10"><a href=""></a><span class="do">## adapts to the boundary automatically and also chooses the polynomial order in</span></span>
<span id="cb8-11"><a href=""></a><span class="do">## a data-driven fashion.</span></span>
<span id="cb8-12"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">as.character</span>(year))</span>
<span id="cb8-13"><a href=""></a>y <span class="ot">&lt;-</span> patent</span>
<span id="cb8-14"><a href=""></a><span class="do">## To most quickly run this example, we take results from a prior run os that in</span></span>
<span id="cb8-15"><a href=""></a><span class="do">## real-time computation proceeds as quickly as possible for illustrative</span></span>
<span id="cb8-16"><a href=""></a><span class="do">## purposes (you can comment out/renable to confirm they produce identical</span></span>
<span id="cb8-17"><a href=""></a><span class="do">## results)</span></span>
<span id="cb8-18"><a href=""></a><span class="co"># f.bkcde &lt;- bkcde(x=x,y=y,proper=TRUE)</span></span>
<span id="cb8-19"><a href=""></a><span class="co"># f.bkcde$h [1] 5.022254 5.233370</span></span>
<span id="cb8-20"><a href=""></a><span class="co"># f.bkcde$degree [1] 0</span></span>
<span id="cb8-21"><a href=""></a>f.bkcde <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">h=</span><span class="fu">c</span>(<span class="fl">5.022254</span>,<span class="fl">5.233370</span>),<span class="at">degree=</span><span class="dv">0</span>,<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-22"><a href=""></a><span class="do">## Estimator of Hall, Racine &amp; Li (polynomial order 0 conditional density estimate)</span></span>
<span id="cb8-23"><a href=""></a><span class="do">## with bandwidth selection via likelihood cross-validation</span></span>
<span id="cb8-24"><a href=""></a><span class="co"># f.hrl &lt;- bkcde(degree.max=0,x=x,y=y,proper=TRUE,y.ub=Inf,y.lb=-Inf,x.ub=Inf,x.lb=-Inf)</span></span>
<span id="cb8-25"><a href=""></a><span class="co"># f.hrl$h [1] 4.166873 5.442247</span></span>
<span id="cb8-26"><a href=""></a><span class="co"># f.hrl$degree [1] 0</span></span>
<span id="cb8-27"><a href=""></a>f.hrl <span class="ot">&lt;-</span> <span class="fu">bkcde</span>(<span class="at">h=</span><span class="fu">c</span>(<span class="fl">4.166873</span>,<span class="fl">5.442247</span>),<span class="at">degree=</span><span class="dv">0</span>,<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">proper=</span><span class="cn">TRUE</span>,<span class="at">y.ub=</span><span class="cn">Inf</span>,<span class="at">y.lb=</span><span class="sc">-</span><span class="cn">Inf</span>,<span class="at">x.ub=</span><span class="cn">Inf</span>,<span class="at">x.lb=</span><span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb8-28"><a href=""></a><span class="do">## In the following plots note that the data has a very long tail (right skewed)</span></span>
<span id="cb8-29"><a href=""></a><span class="do">## so we hone in on firms having 100 or fewer patents/year. We first take</span></span>
<span id="cb8-30"><a href=""></a><span class="do">## univariate histogram and density() estimators for the year 1987, then overlay</span></span>
<span id="cb8-31"><a href=""></a><span class="do">## the conditional kernel density estimates from npcdens() and bkcde() for the</span></span>
<span id="cb8-32"><a href=""></a><span class="do">## same year (these use data for all years). We also plot the bkcde() 2D</span></span>
<span id="cb8-33"><a href=""></a><span class="do">## estimates for the year 1987 without, then with simultaneous confidence</span></span>
<span id="cb8-34"><a href=""></a><span class="do">## intervals. Finally, we plot the bkcde() estimate in 3D with and without</span></span>
<span id="cb8-35"><a href=""></a><span class="do">## confidence intervals (all years). We override the default number of bootstrap</span></span>
<span id="cb8-36"><a href=""></a><span class="do">## replications to 399.</span></span>
<span id="cb8-37"><a href=""></a>B <span class="ot">&lt;-</span> <span class="dv">399</span></span>
<span id="cb8-38"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">cex=</span>.<span class="dv">65</span>,<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb8-39"><a href=""></a><span class="fu">plot</span>(f.bkcde,<span class="at">persp=</span><span class="cn">FALSE</span>,<span class="at">x.eval=</span><span class="dv">1987</span>,<span class="at">y.eval=</span><span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">100</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb8-40"><a href=""></a><span class="fu">hist</span>(y[x<span class="sc">==</span><span class="dv">1987</span>],<span class="at">xlab=</span><span class="st">"Patent counts"</span>,<span class="at">main=</span><span class="st">""</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.06</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">breaks=</span><span class="dv">250</span>)</span>
<span id="cb8-41"><a href=""></a><span class="fu">lines</span>(<span class="fu">density</span>(y[x<span class="sc">==</span><span class="dv">1987</span>],<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">100</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb8-42"><a href=""></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">100</span>),<span class="fu">predict</span>(f.hrl,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">1987</span>,<span class="dv">100</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">100</span>))),</span>
<span id="cb8-43"><a href=""></a>      <span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb8-44"><a href=""></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">100</span>),<span class="fu">predict</span>(f.bkcde,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">1987</span>,<span class="dv">100</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">100</span>))),</span>
<span id="cb8-45"><a href=""></a>      <span class="at">col=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb8-46"><a href=""></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"density() classical kernel [1987 only]"</span>,<span class="st">"HRL classical kernel"</span>,<span class="st">"BKPA boundary kernel"</span>),</span>
<span id="cb8-47"><a href=""></a>       <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb8-48"><a href=""></a><span class="fu">plot</span>(f.bkcde,<span class="at">persp=</span><span class="cn">FALSE</span>,<span class="at">x.eval=</span><span class="dv">1987</span>,<span class="at">y.eval=</span><span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">100</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb8-49"><a href=""></a>     <span class="at">ci=</span><span class="cn">TRUE</span>,<span class="at">ci.method=</span><span class="st">"Simultaneous"</span>,<span class="at">ci.preplot=</span><span class="cn">FALSE</span>,<span class="at">B=</span>B)</span>
<span id="cb8-50"><a href=""></a><span class="fu">plot</span>(f.bkcde,<span class="at">x.eval=</span><span class="fu">seq</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x),<span class="at">length=</span><span class="dv">25</span>),<span class="at">y.eval=</span><span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="dv">100</span>,<span class="at">length=</span><span class="dv">25</span>),</span>
<span id="cb8-51"><a href=""></a>     <span class="at">ci=</span><span class="cn">TRUE</span>,<span class="at">ci.method=</span><span class="st">"Simultaneous"</span>,<span class="at">ci.preplot=</span><span class="cn">FALSE</span>,<span class="at">B=</span>B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</div>
</div>
</section><section id="example---patent-application-data-output" class="slide level2 output-location-slide center"><h2>Example - Patent Application Data</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div id="fig-conditional-patent" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-conditional-patent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="index_files/figure-revealjs/fig-conditional-patent-1.png" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conditional-patent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Conditional KDE for patent data with simultaneous confidence intervals, 2D plot for year 1987, 3D plot for all years
</figcaption></figure>
</div>
</div>
</div></section></section><section><section id="finite-sample-performance-monte-carlo-simulation-results" class="title-slide slide level1 center"><h1>Finite-Sample Performance:<br> Monte Carlo Simulation Results</h1>

</section><section id="simulation-details" class="slide level2 center"><h2>Simulation Details</h2>
<ul>
<li class="fragment"><p>We provide theoretical underpinnings for joint selection of <span class="math inline">\(p\)</span>, <span class="math inline">\(h_y\)</span>, and <span class="math inline">\(h_x\)</span> via least squares cross-validation (LS-CV) minimization of <span class="math display">\[\mathrm{ISE}(p,h_y,h_x)=\int \{\widehat{g}(y | \mathbf{x})-{g}(y | \mathbf{x})\}^2dy\]</span></p></li>
<li class="fragment"><p>However, no data-driven method is guaranteed to always deliver reliable results</p></li>
<li class="fragment"><p>We therefore compare the method with maximum likelihood cross-validation (ML-CV) which maximizes <span class="math display">\[\mathcal{L}(p,h_y,h_x)=\sum_{i=1}^n \log \widehat{g}_{-i}(y_i | \mathbf{x}_i)\]</span></p></li>
<li class="fragment"><p>Both ML-CV and LS-CV perform comparably and appear to deliver consistent estimates</p></li>
</ul></section><section id="simulation-details-1" class="slide level2 center"><h2>Simulation Details</h2>
<ul>
<li class="fragment"><p>We present a range of simulations for the beta and Gaussian densities, <span class="math inline">\(f(y|x)\)</span>, with x being irrelevant, i.e.&nbsp;<span class="math inline">\(f(y|x)=f(y)\)</span>, or the mean of <span class="math inline">\(f(y|x)\)</span> being quadratic in <span class="math inline">\(x\)</span></p></li>
<li class="fragment"><p>We consider sample sizes of <span class="math inline">\(n=100,200,400,800\)</span></p></li>
<li class="fragment">
<p>We conduct <span class="math inline">\(M\)</span> Monte Carlo replications for each scenario and compare</p>
<ul>
<li class="fragment">BKPA: The proposed approach using a polynomial adaptive method and empirical boundary kernel</li>
<li class="fragment">HRL: <span class="citation" data-cites="HALL_RACINE_LI:2004">Hall, Racine, and Li (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2004</a>)</span> which is a local constant method (<span class="math inline">\(p=0\)</span>)</li>
<li class="fragment">FYT: <span class="citation" data-cites="fyt:1996">Fan, Yao, and Tong (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1996</a>)</span> which is a local polynomial method (<span class="math inline">\(p=1\)</span>)</li>
</ul>
</li>
<li class="fragment"><p>Neither <span class="citation" data-cites="HALL_RACINE_LI:2004">Hall, Racine, and Li (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2004</a>)</span> nor <span class="citation" data-cites="fyt:1996">Fan, Yao, and Tong (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1996</a>)</span> make use of boundary information</p></li>
<li class="fragment"><p>For BKPA we conduct search jointly over candidate models of order <span class="math inline">\(p=0,1,2,3,4,5\)</span> and <span class="math inline">\(h_y\)</span> and <span class="math inline">\(h_x\)</span></p></li>
</ul></section><section id="simulation-details-2" class="slide level2 center"><h2>Simulation Details</h2>
<ul>
<li class="fragment"><p>The proposed approach uses the empirical support of <span class="math inline">\(Y\)</span> <span class="math inline">\([\min(Y),\max(Y)]\)</span> for the boundary kernel (we <em>don’t</em> assume bounds <span class="math inline">\([a,b]\)</span> are known a-priori)</p></li>
<li class="fragment"><p>For the Beta distribution, the true bounds are <span class="math inline">\([0,1]\)</span></p></li>
<li class="fragment"><p>For the Gaussian distribution, the true bounds are <span class="math inline">\([-\infty,\infty]\)</span></p></li>
<li class="fragment"><p>HRL: <span class="citation" data-cites="HALL_RACINE_LI:2004">Hall, Racine, and Li (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2004</a>)</span> (<span class="math inline">\(p=0\)</span>) uses the classical bounds, <span class="math inline">\([-\infty,\infty]\)</span></p></li>
<li class="fragment"><p>FYT: <span class="citation" data-cites="fyt:1996">Fan, Yao, and Tong (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1996</a>)</span> (<span class="math inline">\(p=1\)</span>) uses the classical bounds, <span class="math inline">\([-\infty,\infty]\)</span></p></li>
<li class="fragment"><p>The <span class="math inline">\(\mathrm{Beta}(s_1,s_2)\)</span> random variate has mean <span class="math inline">\(s_1/(s_1+s_2)\)</span> and variance <span class="math inline">\(s_1s_2/((s_1+s_2)^2(s_1+s_2+1))\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(X\)</span> is drawn from a <span class="math inline">\(U[0,1]\)</span> distribution which has mean <span class="math inline">\(1/2\)</span> and variance <span class="math inline">\(1/12\)</span></p></li>
</ul></section><section id="simulation-dgps" class="slide level2 center"><h2>Simulation DGPs</h2>

<img data-src="index_files/figure-revealjs/fig-dgp-beta-ml-1.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;9: DGPs for the conditional density simulations (top Beta, bottom Gaussian, figures on the left <span class="math inline">\(X\)</span> irrelevant, figures on the right mean quadratic in <span class="math inline">\(X\)</span>)
</p></section></section><section><section id="candidate-model-comparison" class="title-slide slide level1 center"><h1>Candidate Model Comparison</h1>

</section><section id="candidate-model-comparison-beta-dgp" class="slide level2 center"><h2>Candidate Model Comparison: Beta DGP</h2>
<ul>
<li class="fragment"><p>We conduct Monte Carlo simulations and report the median relative RMSE of fixed polynomial estimators and the polynomial adaptive approach (PA).</p></li>
<li class="fragment"><p>Numbers <span class="math inline">\(&lt;1\)</span> are more efficient than the PA method.</p></li>
<li class="fragment">
<p>If you knew <em>ex ante</em> which polynomial order to select, you would use that.</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1"><span class="math inline">\(B(1,2)\)</span> ML</a></li>
<li><a href="#tabset-1-2"><span class="math inline">\(B(1,2)\)</span> LS</a></li>
<li><a href="#tabset-1-3"><span class="math inline">\(B(1+x^2,2-x^2)\)</span> ML</a></li>
<li><a href="#tabset-1-4"><span class="math inline">\(B(1+x^2,2-x^2)\)</span> LS</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div id="tbl-dgp-beta-ml-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-beta-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Relative RMSE Irrelevant ML
</figcaption><div aria-describedby="tbl-dgp-beta-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.81</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.87</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.95</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">0.96</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.23</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.42</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.55</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.71</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.82</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div id="tbl-dgp-beta-ls-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-beta-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Relative RMSE Irrelevant LS
</figcaption><div aria-describedby="tbl-dgp-beta-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.77</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.87</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.90</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.36</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">0.87</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.09</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.23</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.35</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.50</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.59</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell">
<div id="tbl-dgp-beta-ml-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-beta-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Relative RMSE Quadratic ML
</figcaption><div aria-describedby="tbl-dgp-beta-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.95</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.98</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.99</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.03</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.02</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.00</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">0.99</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.03</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-4">
<div class="cell">
<div id="tbl-dgp-beta-ls-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-beta-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Relative RMSE Quadratic LS
</figcaption><div aria-describedby="tbl-dgp-beta-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.88</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.96</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.97</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.02</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.02</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.00</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">0.99</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.06</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</li>
</ul></section><section id="candidate-model-comparison-gaussian-dgp" class="slide level2 center"><h2>Candidate Model Comparison: Gaussian DGP</h2>
<ul>
<li class="fragment"><p>We conduct Monte Carlo simulations and report the median relative RMSE of fixed polynomial estimators and the polynomial adaptive approach (PA).</p></li>
<li class="fragment"><p>Numbers <span class="math inline">\(&lt;1\)</span> are more efficient than the PA method.</p></li>
<li class="fragment">
<p>If you knew <em>ex ante</em> which polynomial order to select, you would use that.</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1"><span class="math inline">\(N(0,1/12)\)</span> ML</a></li>
<li><a href="#tabset-2-2"><span class="math inline">\(N(0,1/12)\)</span> LS</a></li>
<li><a href="#tabset-2-3"><span class="math inline">\(N(x^2,1/12)\)</span> ML</a></li>
<li><a href="#tabset-2-4"><span class="math inline">\(N(x^2,1/12)\)</span> LS</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div id="tbl-dgp-norm-ml-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-norm-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Relative RMSE Irrelevant ML
</figcaption><div aria-describedby="tbl-dgp-norm-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.86</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.94</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.97</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">0.99</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.29</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.55</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.77</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.89</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">2.05</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<div id="tbl-dgp-norm-ls-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-norm-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Relative RMSE Irrelevant LS
</figcaption><div aria-describedby="tbl-dgp-norm-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.87</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.94</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.96</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">0.97</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.23</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.44</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.60</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.75</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.88</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell">
<div id="tbl-dgp-norm-ml-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-norm-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Relative RMSE Quadratic ML
</figcaption><div aria-describedby="tbl-dgp-norm-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.03</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.04</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.03</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.06</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.01</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">0.99</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.01</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.02</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.00</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-2-4">
<div class="cell">
<div id="tbl-dgp-norm-ls-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dgp-norm-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Relative RMSE Quadratic LS
</figcaption><div aria-describedby="tbl-dgp-norm-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p=5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BKPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.96</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right; font-weight: bold; color: green !important;">0.99</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right; font-weight: bold; color: green !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">800</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.09</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.03</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">0.99</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.00</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.01</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important;">1.01</td>
<td style="text-align: right; font-weight: bold; color: lightgreen !important; font-weight: bold; color: green !important;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</li>
</ul></section></section><section><section id="scale-factor-summaries" class="title-slide slide level1 center"><h1>Scale Factor Summaries</h1>

</section><section id="scale-factor-summaries-beta-dgp" class="slide level2 center"><h2>Scale Factor Summaries: Beta DGP</h2>
<p>The “scale factor” <span class="math inline">\(s\)</span> is an unknown constant that, adjusted for the sample size and data scale, related to the “bandwidth” <span class="math inline">\(h\)</span>, i.e., <span class="math inline">\(h_x=s_x\sigma_x/n^{1/6}\)</span> and <span class="math inline">\(h_y=s_y\sigma_y/n^{1/6}\)</span>, where <span class="math inline">\(n\)</span> is the sample size. The scale factor is estimated by optimizing the cross-validation score. The scale factor summaries below show the median scale factor for the three methods: BKPA, HRL, and FYT, and are presented for the irrelevant <span class="math inline">\(x\)</span> and quadratic <span class="math inline">\(x\)</span> DGPs.</p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-3-1"><span class="math inline">\(B(1,2)\)</span> ML</a></li>
<li><a href="#tabset-3-2"><span class="math inline">\(B(1,2)\)</span> LS</a></li>
<li><a href="#tabset-3-3"><span class="math inline">\(B(1+x^2,2-x^2)\)</span> ML</a></li>
<li><a href="#tabset-3-4"><span class="math inline">\(B(1+x^2,2-x^2)\)</span> LS</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell">
<div id="tbl-sf-beta-cvml-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-beta-cvml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Scale Factor Summary Irrelevant ML
</figcaption><div aria-describedby="tbl-sf-beta-cvml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">164.16</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">14.17</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">17.32</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">124.09</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">855.01</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">15.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">9.96</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">27.78</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">11.97</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">211.85</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">3491.41</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">27.47</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div id="tbl-sf-beta-cvls-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-beta-cvls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Scale Factor Summary Irrelevant LS
</figcaption><div aria-describedby="tbl-sf-beta-cvls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">168.82</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">82.40</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">148.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">245.77</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">350.53</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">176.89</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">105.60</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">69.97</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">282.66</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">235.66</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">19.49</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">56.86</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell">
<div id="tbl-sf-beta-cvml-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-beta-cvml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Scale Factor Summary Quadratic ML
</figcaption><div aria-describedby="tbl-sf-beta-cvml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">154.32</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">1.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">134.70</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.48</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">8.65</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.40</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-3-4">
<div class="cell">
<div id="tbl-sf-beta-cvls-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-beta-cvls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: Scale Factor Summary Quadratic LS
</figcaption><div aria-describedby="tbl-sf-beta-cvls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">68.47</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">82.22</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">1.08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">136.56</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">1.13</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">24.59</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">1.10</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="scale-factor-summaries-gaussian-dgp" class="slide level2 center"><h2>Scale Factor Summaries: Gaussian DGP</h2>
<p>The “scale factor” <span class="math inline">\(s\)</span> is an unknown constant that, adjusted for the sample size and data scale, related to the “bandwidth” <span class="math inline">\(h\)</span>, i.e., <span class="math inline">\(h_x=s_x\sigma_x/n^{1/6}\)</span> and <span class="math inline">\(h_y=s_y\sigma_y/n^{1/6}\)</span>, where <span class="math inline">\(n\)</span> is the sample size. The scale factor is estimated by optimizing the cross-validation score. The scale factor summaries below show the median scale factor for the three methods: BKPA, HRL, and FYT, and are presented for the irrelevant <span class="math inline">\(x\)</span> and quadratic <span class="math inline">\(x\)</span> DGPs.</p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-4-1"><span class="math inline">\(N(0,1/12)\)</span> ML</a></li>
<li><a href="#tabset-4-2"><span class="math inline">\(N(0,1/12)\)</span> LS</a></li>
<li><a href="#tabset-4-3"><span class="math inline">\(N(x^2,1/12)\)</span> ML</a></li>
<li><a href="#tabset-4-4"><span class="math inline">\(N(x^2,1/12)\)</span> LS</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell">
<div id="tbl-sf-norm-cvml-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-norm-cvml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Scale Factor Summary Irrelevant ML
</figcaption><div aria-describedby="tbl-sf-norm-cvml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">266.16</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">5.56</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">5.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">196.13</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">237.23</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">9.03</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">210.18</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">151.93</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">135.52</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">313.45</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">189.00</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">23.38</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell">
<div id="tbl-sf-norm-cvls-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-norm-cvls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14: Scale Factor Summary Irrelevant LS
</figcaption><div aria-describedby="tbl-sf-norm-cvls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">143.08</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">8.21</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">6.07</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">230.41</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">173.55</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">108.38</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">167.52</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">107.13</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">143.41</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">196.63</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">73.74</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">63.79</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell">
<div id="tbl-sf-norm-cvml-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-norm-cvml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;15: Scale Factor Summary Quadratic ML
</figcaption><div aria-describedby="tbl-sf-norm-cvml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.55</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.50</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-4-4">
<div class="cell">
<div id="tbl-sf-norm-cvls-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sf-norm-cvls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16: Scale Factor Summary Quadratic LS
</figcaption><div aria-describedby="tbl-sf-norm-cvls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
BKPA
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
HRL
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FYT
</div></th>
</tr>
<tr class="odd">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sf-x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.50</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section><section><section id="comparison-with-hrl-and-fyt" class="title-slide slide level1 center"><h1>Comparison with HRL and FYT</h1>

</section><section id="comparison-with-hrl-and-fyt-beta-dgp" class="slide level2 center"><h2>Comparison with HRL and FYT: Beta DGP</h2>
<ul>
<li class="fragment"><p>We compare the performance of the proposed method using empirical bounds with the methods of <span class="citation" data-cites="HALL_RACINE_LI:2004">Hall, Racine, and Li (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2004</a>)</span> and <span class="citation" data-cites="fyt:1996">Fan, Yao, and Tong (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1996</a>)</span>, which use a classical kernel presuming infinite support (inappropriate for the Beta).</p></li>
<li class="fragment">
<p>Numbers <span class="math inline">\(&lt;1\)</span> are more efficient than the BKPA method.</p>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-5-1"><span class="math inline">\(B(1,2)\)</span> ML</a></li>
<li><a href="#tabset-5-2"><span class="math inline">\(B(1,2)\)</span> LS</a></li>
<li><a href="#tabset-5-3"><span class="math inline">\(B(1+x^2,2-x^2)\)</span> ML</a></li>
<li><a href="#tabset-5-4"><span class="math inline">\(B(1+x^2,2-x^2)\)</span> LS</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell">
<div id="tbl-beta-cv-ml-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-cv-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17: Median Relative RMSE Irrelevant ML
</figcaption><div aria-describedby="tbl-beta-cv-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">1.39</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">1.73</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">2.80</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell">
<div id="tbl-beta-cv-ls-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-cv-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;18: Median Relative RMSE Irrelevant LS
</figcaption><div aria-describedby="tbl-beta-cv-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">1.37</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">1.84</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">2.14</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">2.47</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell">
<div id="tbl-beta-cv-ml-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-cv-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19: Median Relative RMSE Quadratic ML
</figcaption><div aria-describedby="tbl-beta-cv-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">1.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.38</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">1.32</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.21</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-5-4">
<div class="cell">
<div id="tbl-beta-cv-ls-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-cv-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20: Median Relative RMSE Quadratic LS
</figcaption><div aria-describedby="tbl-beta-cv-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">1.07</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.19</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.16</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</li>
</ul></section><section id="comparison-with-hrl-and-fyt-gaussian-dgp" class="slide level2 center"><h2>Comparison with HRL and FYT: Gaussian DGP</h2>
<ul>
<li class="fragment"><p>We compare the performance of the proposed method using empirical bounds with the methods of <span class="citation" data-cites="HALL_RACINE_LI:2004">Hall, Racine, and Li (<a href="#/references-scrollable" role="doc-biblioref" onclick="">2004</a>)</span> and <span class="citation" data-cites="fyt:1996">Fan, Yao, and Tong (<a href="#/references-scrollable" role="doc-biblioref" onclick="">1996</a>)</span>, which use a classical kernel presuming infinite support (appropriate for the Gaussian).</p></li>
<li class="fragment">
<p>Numbers <span class="math inline">\(&lt;1\)</span> are more efficient than the BKPA method.</p>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-6-1"><span class="math inline">\(N(0,1/12)\)</span> ML</a></li>
<li><a href="#tabset-6-2"><span class="math inline">\(N(0,1/12)\)</span> LS</a></li>
<li><a href="#tabset-6-3"><span class="math inline">\(N(x^2,1/12)\)</span> ML</a></li>
<li><a href="#tabset-6-4"><span class="math inline">\(N(x^2,1/12)\)</span> LS</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell">
<div id="tbl-norm-cv-ml-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-norm-cv-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21: Median Relative RMSE Irrelevant ML
</figcaption><div aria-describedby="tbl-norm-cv-ml-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.97</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">1.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.26</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell">
<div id="tbl-norm-cv-ls-irr" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-norm-cv-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;22: Median Relative RMSE Irrelevant LS
</figcaption><div aria-describedby="tbl-norm-cv-ls-irr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.92</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">1.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">1.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.20</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-6-3">
<div class="cell">
<div id="tbl-norm-cv-ml-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-norm-cv-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;23: Median Relative RMSE Quadratic ML
</figcaption><div aria-describedby="tbl-norm-cv-ml-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.94</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.97</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.98</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-6-4">
<div class="cell">
<div id="tbl-norm-cv-ls-quad" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-norm-cv-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;24: Median Relative RMSE Quadratic LS
</figcaption><div aria-describedby="tbl-norm-cv-ls-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead><tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;">BKPA</th>
<th style="text-align: right;">HLR</th>
<th style="text-align: right;">FYT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.90</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.96</td>
</tr>
<tr class="even">
<td style="text-align: right;">800</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</li>
</ul></section><section id="references-scrollable" class="slide level2 allowframebreaks smaller scrollable"><h2>References (scrollable)</h2>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Boundary Corrected Adaptive CKDE | <a href="https://jeffreyracine.github.io/bk" class="uri">https://jeffreyracine.github.io/bk</a></p>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-NOMAD" class="csl-entry" role="listitem">
Abramson, M. A., C. Audet, G. Couture, J. E. Dennis Jr., and S. Le Digabel. 2022. <span>“The <span>NOMAD</span> Project.”</span> GERAD (Groupe D’Études et de Recherche en Analyse des Décisions). <a href="https://www.gerad.ca/en/software/nomad">https://www.gerad.ca/en/software/nomad</a>.
</div>
<div id="ref-BOUEZMARNI_ROLIN:2003" class="csl-entry" role="listitem">
Bouezmarni, Taoufik, and Jean-Marie Rolin. 2003. <span>“Consistency of the Beta Kernel Density Function Estimator.”</span> <em>The Canadian Journal of Statistics / La Revue Canadienne de Statistique</em> 31 (1): 89–98.
</div>
<div id="ref-BOWMAN:1984" class="csl-entry" role="listitem">
Bowman, A. W. 1984. <span>“An Alternative Method of Cross-Validation for the Smoothing of Density Estimates.”</span> <em>Biometrika</em> 71: 353–60.
</div>
<div id="ref-CHEN:1999" class="csl-entry" role="listitem">
Chen, Song Xi. 1999. <span>“Beta Kernel Estimators for Density Functions.”</span> <em>Computational Statistics &amp; Data Analysis</em> 31 (2): 131–45.
</div>
<div id="ref-CHEN:2000" class="csl-entry" role="listitem">
———. 2000. <span>“Probability Density Function Estimation Using Gamma Kernels.”</span> <em>Annals of the Institute of Statistical Mathematics</em> 52 (3): 471–80.
</div>
<div id="ref-FAN_GIJBELS:1995" class="csl-entry" role="listitem">
Fan, J., and I. Gijbels. 1995. <span>“Adaptive Order Polynomial Fitting: Band- Width Robustification and Bias Reduction.”</span> <em>Journal of Computational and Graphical Statistics</em> 4: 213–27.
</div>
<div id="ref-FAN_GIJBELS:1996" class="csl-entry" role="listitem">
———. 1996. <em>Local Polynomial Modelling and Its Applications</em>. London: Chapman; Hall.
</div>
<div id="ref-fyt:1996" class="csl-entry" role="listitem">
Fan, J., Q. Yao, and H. Tong. 1996. <span>“<span class="nocase">Estimation of conditional densities and sensitivity measures in nonlinear dynamical systems</span>.”</span> <em>Biometrika</em> 83 (1): 189–206. <a href="https://doi.org/10.1093/biomet/83.1.189">https://doi.org/10.1093/biomet/83.1.189</a>.
</div>
<div id="ref-HALL_RACINE:2015" class="csl-entry" role="listitem">
Hall, P., and J. S. Racine. 2015. <span>“Infinite Order Cross-Validated Local Polynomial Regression.”</span> <em>Journal of Econometrics</em> 185 (2): 510–25.
</div>
<div id="ref-HALL_RACINE_LI:2004" class="csl-entry" role="listitem">
Hall, P., J. S. Racine, and Q. Li. 2004. <span>“Cross-Validation and the Estimation of Conditional Probability Densities.”</span> <em>Journal of the American Statistical Association</em> 99 (468): 1015–26.
</div>
<div id="ref-IGARASHI:2016" class="csl-entry" role="listitem">
Igarashi, Gaku. 2016. <span>“Bias Reductions for Beta Kernel Estimation.”</span> <em>Journal of Nonparametric Statistics</em> 28 (1): 1–30.
</div>
<div id="ref-IGARASHI_KAKIZAWA:2014" class="csl-entry" role="listitem">
Igarashi, Gaku, and Yoshihide Kakizawa. 2014. <span>“Re-Formulation of Inverse Gaussian, Reciprocal Inverse Gaussian, and Birnbaum–Saunders Kernel Estimators.”</span> <em>Statistics &amp; Probability Letters</em> 84: 235–46.
</div>
<div id="ref-KIEFER_RACINE:2009" class="csl-entry" role="listitem">
Kiefer, N. M. and J. S. Racine. 2009. <span>“The Smooth Colonel Meets the Reverend.”</span> <em>Journal of Nonparametric Statistics</em> 21: 521–33.
</div>
<div id="ref-KIEFER_RACINE:2015" class="csl-entry" role="listitem">
———. 2015. <span>“The Smooth Colonel and the Reverend Find Common Ground.”</span> <em>Econometric Reviews</em>, (forthcoming).
</div>
<div id="ref-LEDIGABEL:2011" class="csl-entry" role="listitem">
Le Digabel, S. 2011. <span>“Algorithm 909: <span>NOMAD</span>: Nonlinear Optimization with the <span>MADS</span> Algorithm.”</span> <em>ACM Transactions on Mathematical Software</em> 37 (4): 44:1–15.
</div>
<div id="ref-MALEC201457" class="csl-entry" role="listitem">
Malec, Peter, and Melanie Schienle. 2014. <span>“Nonparametric Kernel Density Estimation Near the Boundary.”</span> <em>Computational Statistics &amp; Data Analysis</em> 72: 57–76. https://doi.org/<a href="https://doi.org/10.1016/j.csda.2013.10.023">https://doi.org/10.1016/j.csda.2013.10.023</a>.
</div>
<div id="ref-PARZEN:1962" class="csl-entry" role="listitem">
Parzen, E. 1962. <span>“On Estimation of a Probability Density Function and Mode.”</span> <em>The Annals of Mathematical Statistics</em> 33: 1065–76.
</div>
<div id="ref-RACINE_LI_WANG:2024" class="csl-entry" role="listitem">
Racine, J. S., Q. Li, and Q. Wang. 2024. <span>“Boundary-Adaptive Kernel Density Estimation: The Case of (Near) Uniform Density.”</span> <em>Journal of Nonparametric Statistics</em> 36 (1): 146–64. <a href="https://doi.org/10.1080/10485252.2023.2250011">https://doi.org/10.1080/10485252.2023.2250011</a>.
</div>
<div id="ref-ROSENBLATT:1956" class="csl-entry" role="listitem">
Rosenblatt, M. 1956. <span>“Remarks on Some Nonparametric Estimates of a Density Function.”</span> <em>The Annals of Mathematical Statistics</em> 27: 832–37.
</div>
<div id="ref-RUDEMO:1982" class="csl-entry" role="listitem">
Rudemo, M. 1982. <span>“Empirical Choice of Histograms and Kernel Density Estimators.”</span> <em>Scandinavian Journal of Statistics</em> 9: 65–78.
</div>
<div id="ref-SCAILLET:2004" class="csl-entry" role="listitem">
Scaillet, O. 2004. <span>“Density Estimation Using Inverse and Reciprocal Inverse Gaussian Kernels.”</span> <em>Journal of Nonparametric Statistics</em> 16 (1-2): 217–26.
</div>
<div id="ref-SCOTT:1992" class="csl-entry" role="listitem">
Scott, David W. 1992. <em>Multivariate Density Estimation: Theory, Practice, and Visualization</em>. Wiley.
</div>
<div id="ref-ZHANG_KARUNAMUNI:2010" class="csl-entry" role="listitem">
Zhang, Shunpu, and Rohana J. Karunamuni. 2010. <span>“Boundary Performance of the Beta Kernel Estimators.”</span> <em>Journal of Nonparametric Statistics</em> 22 (1): 81–104.
</div>
</div>
</section></section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="index_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="index_files/libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="index_files/libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="index_files/libs/revealjs/plugin/notes/notes.js"></script><script src="index_files/libs/revealjs/plugin/search/search.js"></script><script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="index_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":null,"id":"9d4cdb6995d08357","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>